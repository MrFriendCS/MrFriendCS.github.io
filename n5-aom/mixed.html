<!DOCTYPE html>
<html lang='en-gb'>

<head>
    <meta charset='utf-8'>
    <meta name='viewport' content='width=device-width, initial-scale=1'>

    <link rel="shortcut icon" href="images/n5.png">

    <link href="styles.css" rel="stylesheet" type="text/css">

    <title>Mixed Numbers</title>

    <style>
        /* See external CSS */
    </style>

</head>

<body>
    <h1>Mixed to Improper</h1>

    <div id='divProblem'>
        <math>
            <mn id="whole">1</mn>
            <mfrac>
                <mn id="numer2">1</mn>
                <mn id="denom2">3</mn>
            </mfrac>
            <mo>=</mo>
            <mfrac>
                <mn id="numer1">4</mn>
                <mn id="denom1">3</mn>
            </mfrac>
        </math>
    </div>

    <div id="divButtons">
        <p id="btnNew" class='button'>New</p>
        <p id="btnShow" class='button'>Show</p>
    </div>

    <script type="module">
        // import {simplify} from '/simplify.js';

        // Add event listeners
        document.getElementById('btnNew').addEventListener('click', newQuestion);
        document.getElementById('btnShow').addEventListener('click', showAnswer);

        // Global variables
        let whole = 1
        let numerator = 1;
        let denominator = 3;

        function newQuestion() {

            // Local variables
            let oldWhole = whole;
            let oldNumerator = numerator;
            let oldDenominator = denominator;

            // Pick new values
            while (denominator == oldDenominator) {
                // Select denominator
                denominator = parseInt(Math.random() * 25) + 2;
            }

            // Select numerator
            while (numerator == oldNumerator) {
                numerator = parseInt(Math.random() * (denominator - 1)) + 1;
            }

            // Simplify numerator and denominator, if possible
            [numerator, denominator] = simplify(numerator, denominator)

            // Select whole
            while (whole == oldWhole) {
                if (denominator >= 13) {
                    whole = parseInt(Math.random() * 5) + 2;
                }
                else {
                    whole = parseInt(Math.random() * 5) + 5;
                }
            }

            // Update problem
            document.getElementById('whole').innerHTML = whole;
            document.getElementById('numer2').innerHTML = numerator;
            document.getElementById('denom2').innerHTML = denominator;

            document.getElementById('numer1').innerHTML = '';
            document.getElementById('denom1').innerHTML = '';

        }

        function showAnswer() {

            // Local variable
            let improper = whole * denominator + numerator;

            // Update problem
            document.getElementById('numer1').innerHTML = improper;
            document.getElementById('denom1').innerHTML = denominator;

        }


        function simplify (value1, value2) {
            // Local variable
            let divided = true;

            while (divided) {
                divided = false;

                if (value1 % 2 == 0 && value2 % 2 == 0) {
                    value1 = value1 / 2;
                    value2 = value2 / 2;
                    divided = true;
                }
                else if (value1 % 3 == 0 && value2 % 3 == 0) {
                    value1 = value1 / 3;
                    value2 = value2 / 3;
                    divided = true;
                }
                else if (value1 % 5 == 0 && value2 % 5 == 0) {
                    value1 = value1 / 5;
                    value2 = value2 / 5;
                    divided = true;
                }
                else if (value1 % 7 == 0 && value2 % 7 == 0) {
                    value1 = value1 / 7;
                    value2 = value2 / 7;
                    divided = true;
                }
                else if (value1 % 13 == 0 && value2 % 13 == 0) {
                    value1 = value1 / 13;
                    value2 = value2 / 13;
                    divided = true;
                }
                else if (value1 % 17 == 0 && value2 % 17 == 0) {
                    value1 = value1 / 17;
                    value2 = value2 / 17;
                    divided = true;
                }
                else if (value1 % 19 == 0 && value2 % 19 == 0) {
                    value1 = value1 / 19;
                    value2 = value2 / 19;
                    divided = true;
                }
                else if (value1 % 23 == 0 && value2 % 23 == 0) {
                    value1 = value1 / 23;
                    value2 = value2 / 23;
                    divided = true;
                }
            }

            return [value1, value2];
        }

    </script>
</body>

</html>
